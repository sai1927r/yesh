{"title":"Statistical Analysis of the Dataset","markdown":{"yaml":{"title":"Statistical Analysis of the Dataset"},"headingText":"Distribution of Variables","containsRefs":false,"markdown":"\n\n\nIt represents the number of visualizations to examine the distribution of different variables in the dataset using the R ggplot2 library. Different plots are produced by each ggplot call; they include histograms for continuous variables like age, bilirubin levels, and platelet counts, and bar charts for categorical variables like drug type, sex, and disease status. Value distribution is efficiently seen by building the histograms with predetermined bin widths. With their thorough overview of the dataset, these visualizations make it easier to spot trends, patterns, and possible outliers in a variety of variables. All things considered, this method effectively condenses the dataset's distributional properties, providing a strong basis for more exploratory data analysis and statistical modeling.\n\n```{r,message=FALSE,warning=FALSE}\ndata = read.csv(\"C:/Users/HP/Downloads/cirrhosis+patient+survival+prediction+dataset-1/cirrhosis.csv\")\nmissing_values <- colSums(is.na(data))\n# If there are missing values, impute them using mean imputation\ndata_imputed <- na.omit(data)\ncirrhosis_data <- na.omit(data_imputed)\nhead(cirrhosis_data)\n```\n\n```{r,message=FALSE,warning=FALSE}\nlibrary(dplyr)  \nlibrary(ggplot2)\n\n\n# Drug\nggplot(data_imputed, aes(x = Drug)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Drug\", y = \"Count\", title = \"Distribution of Drug\")\n\n# Age\nggplot(data_imputed, aes(x = Age)) +\n  geom_histogram(binwidth = 1000, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Age\", y = \"Frequency\", title = \"Distribution of Age\")\n\n# Ascites\nggplot(data_imputed, aes(x = Ascites)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Ascites\", y = \"Count\", title = \"Distribution of Ascites\")\n\n# Hepatomegaly\nggplot(data_imputed, aes(x = Hepatomegaly)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Hepatomegaly\", y = \"Count\", title = \"Distribution of Hepatomegaly\")\n\n# Spiders\nggplot(data_imputed, aes(x = Spiders)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Spiders\", y = \"Count\", title = \"Distribution of Spiders\")\n\n# Edema\nggplot(data_imputed, aes(x = Edema)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Edema\", y = \"Count\", title = \"Distribution of Edema\")\n\n# Bilirubin\nggplot(data_imputed, aes(x = Bilirubin)) +\n  geom_histogram(binwidth = 1, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Bilirubin\", y = \"Frequency\", title = \"Distribution of Bilirubin\")\n\n# Cholesterol\nggplot(data_imputed, aes(x = Cholesterol)) +\n  geom_histogram(binwidth = 50, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Cholesterol\", y = \"Frequency\", title = \"Distribution of Cholesterol\")\n\n# Albumin\nggplot(data_imputed, aes(x = Albumin)) +\n  geom_histogram(binwidth = 0.5, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Albumin\", y = \"Frequency\", title = \"Distribution of Albumin\")\n\n# Copper\nggplot(data_imputed, aes(x = Copper)) +\n  geom_histogram(binwidth = 50, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Copper\", y = \"Frequency\", title = \"Distribution of Copper\")\n\n# Alk_Phos\nggplot(data_imputed, aes(x = Alk_Phos)) +\n  geom_histogram(binwidth = 500, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Alkaline Phosphatase\", y = \"Frequency\", title = \"Distribution of Alkaline Phosphatase\")\n\n# SGOT\nggplot(data_imputed, aes(x = SGOT)) +\n  geom_histogram(binwidth = 10, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"SGOT\", y = \"Frequency\", title = \"Distribution of SGOT\")\n\n# Triglycerides\nggplot(data_imputed, aes(x = Tryglicerides)) +\n  geom_histogram(binwidth = 10, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Triglycerides\", y = \"Frequency\", title = \"Distribution of Triglycerides\")\n\n# Platelets\nggplot(data_imputed, aes(x = Platelets)) +\n  geom_histogram(binwidth = 50, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Platelets\", y = \"Frequency\", title = \"Distribution of Platelets\")\n\n# Prothrombin\nggplot(data_imputed, aes(x = Prothrombin)) +\n  geom_histogram(binwidth = 0.5, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Prothrombin\", y = \"Frequency\", title = \"Distribution of Prothrombin\")\n\n# Stage\nggplot(data_imputed, aes(x = Stage)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Stage\", y = \"Count\", title = \"Distribution of Stage\")\n\n```\n\n### Disease affecting the target variable\n\nA chi-square test is a statistical test used to compare observed results with expected results. The purpose of these chi-square tests is to evaluate the relationship between the target variable Status and each disease-related characteristic (edema, spiders, hepatomegaly, and ascites). The distribution of the disease-related characteristic is independent of the severity of the condition represented by Status, according to the null hypothesis for each test, which states that there is no association between the disease-related feature and Status. An relationship between the two variables is the alternate hypothesis.\\\nEach chi-square test's p-value expresses the likelihood of seeing the data in the event that the null hypothesis were correct. A low p-value (\\< 0.05) indicates that there is enough data to rule out the null hypothesis and draw the conclusion that Status and the disease-related characteristic are significantly correlated.\n\n```{r,message=FALSE,warning=FALSE}\n\n# Create contingency tables for each disease-related feature and Status\ntable_ascites <- table(data_imputed$Ascites, data_imputed$Status)\ntable_hepatomegaly <- table(data_imputed$Hepatomegaly, data_imputed$Status)\ntable_spiders <- table(data_imputed$Spiders, data_imputed$Status)\ntable_edema <- table(data_imputed$Edema, data_imputed$Status)\n\n# Visualize the relationship using stacked bar charts\npar(mfrow = c(2, 2))  # Set up a 2x2 layout for plots\nbarplot(table_ascites, beside = TRUE, legend = TRUE, main = \"Ascites vs. Status\")\nbarplot(table_hepatomegaly, beside = TRUE, legend = TRUE, main = \"Hepatomegaly vs. Status\")\nbarplot(table_spiders, beside = TRUE, legend = TRUE, main = \"Spiders vs. Status\")\nbarplot(table_edema, beside = TRUE, legend = TRUE, main = \"Edema vs. Status\")\n\n# Conduct chi-square tests for independence\nchi_sq_ascites <- chisq.test(table_ascites)\nchi_sq_hepatomegaly <- chisq.test(table_hepatomegaly)\nchi_sq_spiders <- chisq.test(table_spiders)\nchi_sq_edema <- chisq.test(table_edema)\n\n# Print the results of chi-square tests\nprint(\"Chi-square test results for Ascites vs. Status:\")\nprint(chi_sq_ascites)\nprint(\"Chi-square test results for Hepatomegaly vs. Status:\")\nprint(chi_sq_hepatomegaly)\nprint(\"Chi-square test results for Spiders vs. Status:\")\nprint(chi_sq_spiders)\nprint(\"Chi-square test results for Edema vs. Status:\")\nprint(chi_sq_edema)\n\n```\n\nAlthough the p-value (0.0007102) is slightly larger than the typical significance level of 0.05, it is still considered statistically significant. Thus, we conclude that there is a significant association between Spiders and Status.\n\n### Clustering\n\nThe thresholds for aberrant values derived from broad reference ranges for a variety of laboratory measures that are frequently linked to the health and function of the liver.\n\nTo find patient groups with comparable laboratory profiles, we apply k-means clustering to the scaled laboratory values.\n\nConstruction of a survival object based on the time to an event death and fits a survival model using the Kaplan-Meier estimator. Kaplan-Meier survival curves are plotted for each cluster, showing the probability of survival over time.\n\n```{r,message=FALSE,warning=FALSE}\n# Define thresholds for abnormal values based on general reference ranges\nthresholds <- list(\n  Bilirubin = c(0.3, 1.2),              # Normal total bilirubin levels (mg/dL)\n  Cholesterol = c(0, 200),               # Normal total cholesterol levels (mg/dL)\n  Albumin = c(3.5, 5.0),                 # Normal serum albumin levels (g/dL)\n  Copper = c(70, 140),                   # Normal serum copper levels (µg/dL)\n  Alk_Phos = c(44, 147),                 # Normal alkaline phosphatase levels (IU/L)\n  SGOT = c(0, 40),                       # Normal serum glutamic-oxaloacetic transaminase levels (IU/L)\n  Tryglicerides = c(0, 150),             # Normal triglyceride levels (mg/dL)\n  Platelets = c(150, 450),         # Normal platelet counts (per microliter of blood)\n  Prothrombin = c(11, 13.5)              # Normal prothrombin time (seconds)\n)\n\n# Select the relevant lab value columns\nlab_columns <- cirrhosis_data %>%\n  select(Bilirubin, Cholesterol, Albumin, Copper, Alk_Phos, SGOT, Tryglicerides, Platelets, Prothrombin)\n\n# Ensure numeric lab values\nlab_columns <- lab_columns %>% mutate_all(as.numeric)\n\n# Identify rows without missing values\ncomplete_cases <- complete.cases(lab_columns)\n\n# Filter both the original and lab data based on complete rows\nlab_values <- lab_columns[complete_cases, ]\ncirrhosis_data_clean <- cirrhosis_data[complete_cases, ]\n\n# Apply k-means clustering\nset.seed(123)\nkmeans_clusters <- kmeans(scale(lab_values), centers = 3)  # Adjust the number of clusters as needed\ncirrhosis_data_clean$Cluster <- as.factor(kmeans_clusters$cluster)\n\n# Function to classify values based on thresholds\nclassify_abnormal <- function(value, range) {\n  if (is.na(value)) {\n    return(NA)\n  } else if (value < range[1] || value > range[2]) {\n    return(\"Abnormal\")\n  } else {\n    return(\"Normal\")\n  }\n}\n\n# Apply the function to classify each lab value based on the thresholds\nfor (param in names(thresholds)) {\n  cirrhosis_data_clean[[paste0(param, \"_Class\")]] <- mapply(classify_abnormal, cirrhosis_data_clean[[param]], MoreArgs = list(range = thresholds[[param]]))\n}\n\n# Calculate the proportion of abnormal lab values per cluster\nabnormal_props <- cirrhosis_data_clean %>%\n  group_by(Cluster) %>%\n  summarize(across(ends_with(\"_Class\"), ~ mean(. == \"Abnormal\", na.rm = TRUE)))\n\nprint(abnormal_props)\n\n# Survival Analysis\nlibrary(survival)\n\n# Create the survival object\nsurv_obj <- Surv(time = cirrhosis_data_clean$N_Days, event = ifelse(cirrhosis_data_clean$Status == \"D\", 1, 0))\n\n# Fit the survival model by clusters\nfit <- survfit(surv_obj ~ Cluster, data = cirrhosis_data_clean)\n\n# Plot Kaplan-Meier survival curves\nplot(fit, col = 1:3, lty = 1:3, xlab = \"Time (days)\", ylab = \"Survival Probability\")\nlegend(\"topright\", legend = levels(cirrhosis_data_clean$Cluster), col = 1:3, lty = 1:3)\n\n# Log-rank test to compare survival curves\nlog_rank_test <- survdiff(surv_obj ~ Cluster, data = cirrhosis_data_clean)\np_value <- 1 - pchisq(log_rank_test$chisq, length(log_rank_test$n) - 1)\ntitle(sub = paste(\"Log-rank p-value:\", round(p_value, 4)))\n```\n\n### Describing which variables are heavily abnormal\n\nIn general, this code offers a methodical approach to recognize observations that display significant departures from typical values for several laboratory parameters, assisting in the identification of potentially alarming situations that require additional examination.\n\n```{r,message=FALSE,warning=FALSE}\n# Calculate the midpoint of the threshold range for each variable\nthreshold_midpoints <- sapply(thresholds, function(x) mean(x))\n\n# Calculate the distance of each observation's value from the midpoint of the threshold range for each variable\ndistances <- sapply(names(thresholds), function(var) abs(cirrhosis_data_clean[[var]] - threshold_midpoints[var]))\n\n# Summarize the distance across all threshold variables for each observation\ntotal_distance <- rowSums(distances)\n\n# Define a threshold for defining \"heavily abnormal\" observations\nthreshold_distance <- 3  # Example threshold (can be adjusted based on your requirements)\n\n# Determine which variables are heavily abnormal for each observation\nheavily_abnormal_vars <- apply(distances, 1, function(x) names(thresholds)[x > threshold_distance])\n\n# Create a new column indicating observations where the summarized distance exceeds the defined threshold\ncirrhosis_data_clean$Heavily_Abnormal <- ifelse(total_distance > threshold_distance, paste0(\"(\", paste(heavily_abnormal_vars, collapse = \", \"), \")\"), \"\")\n```\n\n### Overall summary of dataset\n\nAn overview of each variable's value distribution is given by this, making it easier to see any potential outliers or odd patterns, boxplots to see how the same variables are distributed. Boxplots make it simple to compare distributions across variables by displaying the data's median, quartiles, and any outliers. In general, this code offers a methodical approach to recognize observations that display significant departures from typical values for several laboratory parameters, assisting in the identification of potentially alarming situations that require additional examination.\n\n```{r,message=FALSE,warning=FALSE}\n# Calculate summary statistics\nsummary_stats <- summary(data_imputed[, c(\"Bilirubin\", \"Cholesterol\", \"Albumin\", \"Copper\", \"Alk_Phos\", \"SGOT\", \"Tryglicerides\", \"Platelets\", \"Prothrombin\")])\nprint(summary_stats)\n\n#measures such as mean, median, standard deviation, minimum, and maximum. This will give you an overview of the distribution of values and help identify potential outliers.\n\n\n# Visualize the distribution using boxplots\nboxplot(data[, c(\"Bilirubin\", \"Cholesterol\", \"Albumin\", \"Copper\", \"Alk_Phos\", \"SGOT\", \"Tryglicerides\", \"Platelets\", \"Prothrombin\")])\n```\n","srcMarkdownNoYaml":"\n\n### Distribution of Variables\n\nIt represents the number of visualizations to examine the distribution of different variables in the dataset using the R ggplot2 library. Different plots are produced by each ggplot call; they include histograms for continuous variables like age, bilirubin levels, and platelet counts, and bar charts for categorical variables like drug type, sex, and disease status. Value distribution is efficiently seen by building the histograms with predetermined bin widths. With their thorough overview of the dataset, these visualizations make it easier to spot trends, patterns, and possible outliers in a variety of variables. All things considered, this method effectively condenses the dataset's distributional properties, providing a strong basis for more exploratory data analysis and statistical modeling.\n\n```{r,message=FALSE,warning=FALSE}\ndata = read.csv(\"C:/Users/HP/Downloads/cirrhosis+patient+survival+prediction+dataset-1/cirrhosis.csv\")\nmissing_values <- colSums(is.na(data))\n# If there are missing values, impute them using mean imputation\ndata_imputed <- na.omit(data)\ncirrhosis_data <- na.omit(data_imputed)\nhead(cirrhosis_data)\n```\n\n```{r,message=FALSE,warning=FALSE}\nlibrary(dplyr)  \nlibrary(ggplot2)\n\n\n# Drug\nggplot(data_imputed, aes(x = Drug)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Drug\", y = \"Count\", title = \"Distribution of Drug\")\n\n# Age\nggplot(data_imputed, aes(x = Age)) +\n  geom_histogram(binwidth = 1000, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Age\", y = \"Frequency\", title = \"Distribution of Age\")\n\n# Ascites\nggplot(data_imputed, aes(x = Ascites)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Ascites\", y = \"Count\", title = \"Distribution of Ascites\")\n\n# Hepatomegaly\nggplot(data_imputed, aes(x = Hepatomegaly)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Hepatomegaly\", y = \"Count\", title = \"Distribution of Hepatomegaly\")\n\n# Spiders\nggplot(data_imputed, aes(x = Spiders)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Spiders\", y = \"Count\", title = \"Distribution of Spiders\")\n\n# Edema\nggplot(data_imputed, aes(x = Edema)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Edema\", y = \"Count\", title = \"Distribution of Edema\")\n\n# Bilirubin\nggplot(data_imputed, aes(x = Bilirubin)) +\n  geom_histogram(binwidth = 1, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Bilirubin\", y = \"Frequency\", title = \"Distribution of Bilirubin\")\n\n# Cholesterol\nggplot(data_imputed, aes(x = Cholesterol)) +\n  geom_histogram(binwidth = 50, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Cholesterol\", y = \"Frequency\", title = \"Distribution of Cholesterol\")\n\n# Albumin\nggplot(data_imputed, aes(x = Albumin)) +\n  geom_histogram(binwidth = 0.5, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Albumin\", y = \"Frequency\", title = \"Distribution of Albumin\")\n\n# Copper\nggplot(data_imputed, aes(x = Copper)) +\n  geom_histogram(binwidth = 50, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Copper\", y = \"Frequency\", title = \"Distribution of Copper\")\n\n# Alk_Phos\nggplot(data_imputed, aes(x = Alk_Phos)) +\n  geom_histogram(binwidth = 500, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Alkaline Phosphatase\", y = \"Frequency\", title = \"Distribution of Alkaline Phosphatase\")\n\n# SGOT\nggplot(data_imputed, aes(x = SGOT)) +\n  geom_histogram(binwidth = 10, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"SGOT\", y = \"Frequency\", title = \"Distribution of SGOT\")\n\n# Triglycerides\nggplot(data_imputed, aes(x = Tryglicerides)) +\n  geom_histogram(binwidth = 10, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Triglycerides\", y = \"Frequency\", title = \"Distribution of Triglycerides\")\n\n# Platelets\nggplot(data_imputed, aes(x = Platelets)) +\n  geom_histogram(binwidth = 50, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Platelets\", y = \"Frequency\", title = \"Distribution of Platelets\")\n\n# Prothrombin\nggplot(data_imputed, aes(x = Prothrombin)) +\n  geom_histogram(binwidth = 0.5, fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Prothrombin\", y = \"Frequency\", title = \"Distribution of Prothrombin\")\n\n# Stage\nggplot(data_imputed, aes(x = Stage)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  labs(x = \"Stage\", y = \"Count\", title = \"Distribution of Stage\")\n\n```\n\n### Disease affecting the target variable\n\nA chi-square test is a statistical test used to compare observed results with expected results. The purpose of these chi-square tests is to evaluate the relationship between the target variable Status and each disease-related characteristic (edema, spiders, hepatomegaly, and ascites). The distribution of the disease-related characteristic is independent of the severity of the condition represented by Status, according to the null hypothesis for each test, which states that there is no association between the disease-related feature and Status. An relationship between the two variables is the alternate hypothesis.\\\nEach chi-square test's p-value expresses the likelihood of seeing the data in the event that the null hypothesis were correct. A low p-value (\\< 0.05) indicates that there is enough data to rule out the null hypothesis and draw the conclusion that Status and the disease-related characteristic are significantly correlated.\n\n```{r,message=FALSE,warning=FALSE}\n\n# Create contingency tables for each disease-related feature and Status\ntable_ascites <- table(data_imputed$Ascites, data_imputed$Status)\ntable_hepatomegaly <- table(data_imputed$Hepatomegaly, data_imputed$Status)\ntable_spiders <- table(data_imputed$Spiders, data_imputed$Status)\ntable_edema <- table(data_imputed$Edema, data_imputed$Status)\n\n# Visualize the relationship using stacked bar charts\npar(mfrow = c(2, 2))  # Set up a 2x2 layout for plots\nbarplot(table_ascites, beside = TRUE, legend = TRUE, main = \"Ascites vs. Status\")\nbarplot(table_hepatomegaly, beside = TRUE, legend = TRUE, main = \"Hepatomegaly vs. Status\")\nbarplot(table_spiders, beside = TRUE, legend = TRUE, main = \"Spiders vs. Status\")\nbarplot(table_edema, beside = TRUE, legend = TRUE, main = \"Edema vs. Status\")\n\n# Conduct chi-square tests for independence\nchi_sq_ascites <- chisq.test(table_ascites)\nchi_sq_hepatomegaly <- chisq.test(table_hepatomegaly)\nchi_sq_spiders <- chisq.test(table_spiders)\nchi_sq_edema <- chisq.test(table_edema)\n\n# Print the results of chi-square tests\nprint(\"Chi-square test results for Ascites vs. Status:\")\nprint(chi_sq_ascites)\nprint(\"Chi-square test results for Hepatomegaly vs. Status:\")\nprint(chi_sq_hepatomegaly)\nprint(\"Chi-square test results for Spiders vs. Status:\")\nprint(chi_sq_spiders)\nprint(\"Chi-square test results for Edema vs. Status:\")\nprint(chi_sq_edema)\n\n```\n\nAlthough the p-value (0.0007102) is slightly larger than the typical significance level of 0.05, it is still considered statistically significant. Thus, we conclude that there is a significant association between Spiders and Status.\n\n### Clustering\n\nThe thresholds for aberrant values derived from broad reference ranges for a variety of laboratory measures that are frequently linked to the health and function of the liver.\n\nTo find patient groups with comparable laboratory profiles, we apply k-means clustering to the scaled laboratory values.\n\nConstruction of a survival object based on the time to an event death and fits a survival model using the Kaplan-Meier estimator. Kaplan-Meier survival curves are plotted for each cluster, showing the probability of survival over time.\n\n```{r,message=FALSE,warning=FALSE}\n# Define thresholds for abnormal values based on general reference ranges\nthresholds <- list(\n  Bilirubin = c(0.3, 1.2),              # Normal total bilirubin levels (mg/dL)\n  Cholesterol = c(0, 200),               # Normal total cholesterol levels (mg/dL)\n  Albumin = c(3.5, 5.0),                 # Normal serum albumin levels (g/dL)\n  Copper = c(70, 140),                   # Normal serum copper levels (µg/dL)\n  Alk_Phos = c(44, 147),                 # Normal alkaline phosphatase levels (IU/L)\n  SGOT = c(0, 40),                       # Normal serum glutamic-oxaloacetic transaminase levels (IU/L)\n  Tryglicerides = c(0, 150),             # Normal triglyceride levels (mg/dL)\n  Platelets = c(150, 450),         # Normal platelet counts (per microliter of blood)\n  Prothrombin = c(11, 13.5)              # Normal prothrombin time (seconds)\n)\n\n# Select the relevant lab value columns\nlab_columns <- cirrhosis_data %>%\n  select(Bilirubin, Cholesterol, Albumin, Copper, Alk_Phos, SGOT, Tryglicerides, Platelets, Prothrombin)\n\n# Ensure numeric lab values\nlab_columns <- lab_columns %>% mutate_all(as.numeric)\n\n# Identify rows without missing values\ncomplete_cases <- complete.cases(lab_columns)\n\n# Filter both the original and lab data based on complete rows\nlab_values <- lab_columns[complete_cases, ]\ncirrhosis_data_clean <- cirrhosis_data[complete_cases, ]\n\n# Apply k-means clustering\nset.seed(123)\nkmeans_clusters <- kmeans(scale(lab_values), centers = 3)  # Adjust the number of clusters as needed\ncirrhosis_data_clean$Cluster <- as.factor(kmeans_clusters$cluster)\n\n# Function to classify values based on thresholds\nclassify_abnormal <- function(value, range) {\n  if (is.na(value)) {\n    return(NA)\n  } else if (value < range[1] || value > range[2]) {\n    return(\"Abnormal\")\n  } else {\n    return(\"Normal\")\n  }\n}\n\n# Apply the function to classify each lab value based on the thresholds\nfor (param in names(thresholds)) {\n  cirrhosis_data_clean[[paste0(param, \"_Class\")]] <- mapply(classify_abnormal, cirrhosis_data_clean[[param]], MoreArgs = list(range = thresholds[[param]]))\n}\n\n# Calculate the proportion of abnormal lab values per cluster\nabnormal_props <- cirrhosis_data_clean %>%\n  group_by(Cluster) %>%\n  summarize(across(ends_with(\"_Class\"), ~ mean(. == \"Abnormal\", na.rm = TRUE)))\n\nprint(abnormal_props)\n\n# Survival Analysis\nlibrary(survival)\n\n# Create the survival object\nsurv_obj <- Surv(time = cirrhosis_data_clean$N_Days, event = ifelse(cirrhosis_data_clean$Status == \"D\", 1, 0))\n\n# Fit the survival model by clusters\nfit <- survfit(surv_obj ~ Cluster, data = cirrhosis_data_clean)\n\n# Plot Kaplan-Meier survival curves\nplot(fit, col = 1:3, lty = 1:3, xlab = \"Time (days)\", ylab = \"Survival Probability\")\nlegend(\"topright\", legend = levels(cirrhosis_data_clean$Cluster), col = 1:3, lty = 1:3)\n\n# Log-rank test to compare survival curves\nlog_rank_test <- survdiff(surv_obj ~ Cluster, data = cirrhosis_data_clean)\np_value <- 1 - pchisq(log_rank_test$chisq, length(log_rank_test$n) - 1)\ntitle(sub = paste(\"Log-rank p-value:\", round(p_value, 4)))\n```\n\n### Describing which variables are heavily abnormal\n\nIn general, this code offers a methodical approach to recognize observations that display significant departures from typical values for several laboratory parameters, assisting in the identification of potentially alarming situations that require additional examination.\n\n```{r,message=FALSE,warning=FALSE}\n# Calculate the midpoint of the threshold range for each variable\nthreshold_midpoints <- sapply(thresholds, function(x) mean(x))\n\n# Calculate the distance of each observation's value from the midpoint of the threshold range for each variable\ndistances <- sapply(names(thresholds), function(var) abs(cirrhosis_data_clean[[var]] - threshold_midpoints[var]))\n\n# Summarize the distance across all threshold variables for each observation\ntotal_distance <- rowSums(distances)\n\n# Define a threshold for defining \"heavily abnormal\" observations\nthreshold_distance <- 3  # Example threshold (can be adjusted based on your requirements)\n\n# Determine which variables are heavily abnormal for each observation\nheavily_abnormal_vars <- apply(distances, 1, function(x) names(thresholds)[x > threshold_distance])\n\n# Create a new column indicating observations where the summarized distance exceeds the defined threshold\ncirrhosis_data_clean$Heavily_Abnormal <- ifelse(total_distance > threshold_distance, paste0(\"(\", paste(heavily_abnormal_vars, collapse = \", \"), \")\"), \"\")\n```\n\n### Overall summary of dataset\n\nAn overview of each variable's value distribution is given by this, making it easier to see any potential outliers or odd patterns, boxplots to see how the same variables are distributed. Boxplots make it simple to compare distributions across variables by displaying the data's median, quartiles, and any outliers. In general, this code offers a methodical approach to recognize observations that display significant departures from typical values for several laboratory parameters, assisting in the identification of potentially alarming situations that require additional examination.\n\n```{r,message=FALSE,warning=FALSE}\n# Calculate summary statistics\nsummary_stats <- summary(data_imputed[, c(\"Bilirubin\", \"Cholesterol\", \"Albumin\", \"Copper\", \"Alk_Phos\", \"SGOT\", \"Tryglicerides\", \"Platelets\", \"Prothrombin\")])\nprint(summary_stats)\n\n#measures such as mean, median, standard deviation, minimum, and maximum. This will give you an overview of the distribution of values and help identify potential outliers.\n\n\n# Visualize the distribution using boxplots\nboxplot(data[, c(\"Bilirubin\", \"Cholesterol\", \"Albumin\", \"Copper\", \"Alk_Phos\", \"SGOT\", \"Tryglicerides\", \"Platelets\", \"Prothrombin\")])\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"about.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","code-summary":"Show the code","theme":"flatly","title":"Statistical Analysis of the Dataset"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}